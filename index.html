<!-- build time:Tue Feb 04 2020 23:30:45 GMT+0800 (China Standard Time) --><!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Consolas:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"><link rel="stylesheet" href="/css/main.css?v=7.1.2"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=7.1.2"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.2"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.2"><link rel="mask-icon" href="/images/logo.svg?v=7.1.2" color="#222"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"7.1.2",sidebar:{position:"left",display:"post",offset:12,onmobile:!1,dimmer:!1},back2top:!0,back2top_sidebar:!1,fancybox:!1,fastclick:!1,lazyload:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta name="description" content="飞翔的Huster"><meta name="keywords" content="计算机科学与技术,网络空间安全,作曲与作曲技术理论"><meta property="og:type" content="website"><meta property="og:title" content="The Flying Huster"><meta property="og:url" content="https://www.flyinghuster.com/index.html"><meta property="og:site_name" content="The Flying Huster"><meta property="og:description" content="飞翔的Huster"><meta property="og:locale" content="zh"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="The Flying Huster"><meta name="twitter:description" content="飞翔的Huster"><link rel="alternate" href="/atom.xml" title="The Flying Huster" type="application/atom+xml"><link rel="canonical" href="https://www.flyinghuster.com/"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>The Flying Huster – 记录科研生活的点点滴滴</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh"><div class="container sidebar-position-left page-home"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">The Flying Huster</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">记录科研生活的点点滴滴</h1></div><div class="site-nav-toggle"><button aria-label="Toggle navigation bar"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home menu-item-active"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>Archives<span class="badge">43</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>Categories<span class="badge">27</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>Tags<span class="badge">38</span></a></li><li class="menu-item menu-item-gallery"><a href="https://www.gallery.flyinghuster.com" rel="noopener" target="_blank"><i class="menu-item-icon fa fa-fw fa-photo"></i><br>Gallery</a></li><li class="menu-item menu-item-intro"><a href="/intro/" rel="section"><i class="menu-item-icon fa fa-fw fa-info"></i><br>intro</a></li><li class="menu-item menu-item-about"><a href="https://www.xkliu.com/resume" rel="noopener" target="_blank"><i class="menu-item-icon fa fa-fw fa-user"></i><br>About</a></li><li class="menu-item menu-item-weekend-composer"><a href="https://www.weekendcomposer.com" rel="noopener" target="_blank"><i class="menu-item-icon fa fa-fw fa-music"></i><br>Weekend Composer</a></li><li class="menu-item menu-item-live"><a href="https://www.xkliu.com" rel="noopener" target="_blank"><i class="menu-item-icon fa fa-fw fa-coffee"></i><br>live</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>Search</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><a href="https://github.com/johannesliu" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.flyinghuster.com/SpringCloud分布式微服务架构实战学习笔记（一）微服务架构概述/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="刘中岳"><meta itemprop="description" content="飞翔的Huster"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="The Flying Huster"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/SpringCloud分布式微服务架构实战学习笔记（一）微服务架构概述/" class="post-title-link" itemprop="url">SpringCloud分布式微服务架构实战学习笔记（一）微服务架构概述</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-02-03 12:48:29" itemprop="dateCreated datePublished" datetime="2020-02-03T12:48:29+08:00">2020-02-03</time></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span title="Symbols count in article">0</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">1 mins.</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h1><p>本笔记是对梦学谷课程Spring Cloud微服务课程的总结。笔者在梦雪谷相关课程中收获颇丰。请支持正版课程。</p><h1 id="微服务概述"><a href="#微服务概述" class="headerlink" title="微服务概述"></a>微服务概述</h1><p>马丁·福勒 ，他于2014年发表了一篇关于微服务的博客<br>博客：<a href="https://martinfowler.com/microservices/" target="_blank" rel="noopener">https://martinfowler.com/microservices/</a><br>微服务详细文档：<br>英文：<a href="https://martinfowler.com/articles/microservices.html#MicroservicesAndSoa微服务是一种架构风格，是以开发一组小型服务的方式来作为一个独立的应用系统，每个服务都运行在自已的进程中，服务之间采用轻量级的HTTP通信机制" target="_blank" rel="noopener">https://martinfowler.com/articles/microservices.html#MicroservicesAndSoa微服务是一种架构风格，是以开发一组小型服务的方式来作为一个独立的应用系统，每个服务都运行在自已的进程中，服务之间采用轻量级的HTTP通信机制</a> ( 通常是采用HTTP的RESTful API )进行通信。这些服务都是围绕具体业务进行构建的，并且可以独立部署到生产环境上。这些服务可以用不同的编程语言编写，并且可以使用不同的数据存储技术。对这些微服务我们只需要使用一个非常轻量级的集中式管<br>理来进行协调。</p><h1 id="单体应用架构"><a href="#单体应用架构" class="headerlink" title="单体应用架构"></a>单体应用架构</h1><ul><li>单体应用架构概念<br>一个应用中包含了应用程序的所有功能（比如：页面，代码，配置等），把应用打成一个war或jar包部署到<br>Tomcat中，通常称为单体应用架构。</li><li>单体架构图<br><img src="/source/_posts/SpringCloud分布式微服务架构实战学习笔记（一）微服务架构概述/单体架构应用.png" alt="单体架构应用"></li><li>单体应用架构的优缺点<br>优点 易于开发&amp;测试：单个应用包含所有功能，不涉及多个应用的互联互调，便于在团队之间开发与测<br>试。 易于部署：只需将单个应用打成war或jar包，进行部署到Tomcat即可，运维起来比较方便。<br>易于整体扩展：当应用负载压力大时，将这个应用复制几份，分别部署在不同的服务器上，再通过负载<br>均衡即可提高应用的并发能力。<br>缺点 复杂性高：由于是单个应用，所以整个项目文件包含的模块非常多，导致模块的边界模糊、依赖关<br>系不清晰、代码的质量参差不齐，混乱的堆在一起，使得整个项目非常复杂。以致每次修改代码，都非<br>常小心，可能添加一个简单的功能，或者修改一个Bug都会带来隐藏的缺陷。 技术债务：随着时间的推<br>移、需求的变更和技术人员的更替，会逐渐形成应用程序的技术债务，并且越积越多。 阻碍技术创新：<br>对于单体应用来说，技术是在开发之前经过慎重评估后选定的，每个团队成员都必须使用相同的开发语<br>言、持久化存储及消息系统。</li></ul><h1 id="微服务架构"><a href="#微服务架构" class="headerlink" title="微服务架构"></a>微服务架构</h1><ul><li>微服务架构概念<br>微服务是一种架构风格，是以开发一组小型服务的方式来作为一个独立的应用系统，每个服务都运行在自已<br>的进程中，服务之间采用轻量级的HTTP通信机制 ( 通常是采用HTTP的RESTful API )进行通信。这些服务都<br>是围绕具体业务进行构建的，并且可以独立部署到生产环境上。这些服务可以用不同的编程语言编写，并且<br>可以使用不同的数据存储技术。对这些微服务我们只需要使用一个非常轻量级的集中式管理来进行协调。</li><li>微服务架构图<br><img src="/source/_posts/SpringCloud分布式微服务架构实战学习笔记（一）微服务架构概述/微服务架构图.png" alt="微服务架构图"></li></ul><ul><li>微服务架构的优缺点<ul><li>优点</li></ul></li></ul><ol><li>易于开发和维护：一个微服务只会关注一个特定的业务功能，所以业务清晰、代码量较少。开发和<br>维护单个微服务相对简单。</li><li>单个微服务启动较快</li><li>局部修改容易部署：单一应用只要有修改，就得重新部署整个应用。微服务解决了这样的问题。一<br>般来说，对某个微服务进行修改，只需要重新部署这个服务即可。</li><li>技术栈不受限制：在微服务架构中，可以结合项目业务及团队的特点，合理的选择技术栈。</li><li>按需伸缩：可根据需求，实现细粒度的扩展。<ul><li>缺点</li></ul></li><li>运维要求高：更多的服务意味着要投入更多的运维。</li><li>分布式固有的复杂性：使用微服务构建的是分布式系统。对于一个分布式系统，系统容错、网络延<br>迟、分布式事务等都会带来巨大的问题。</li><li>接口调整成本高：微服务之间通过接口进行通信。如果修改某一个微服务的API，可能所有用到这<br>个接口的微服务都需要进行调整。</li></ol><ul><li>微服务架构总结：<ul><li>微服务的核心就是将传统的单一应用，根据业务拆分成一个一个的服务，彻底地去耦合,每一个微服务提<br>供单个业务功能的服务，一个服务做一件事。</li></ul></li><li>在 IDEA 工具中使用Maven构建的一个个独立的 Module ，也就是使用Spring Boot 开发的一个个小模块<br>就是一个个微服务，将专业的事交给专业的模块来做。比如一个大型项目可能有上百个微服务，将这些<br>微服务集中起来构成一个大的系统，对外暴露服务进行调用与使用。</li><li>从技术角度看就是一种小而独立的处理过程，类似进程概念，能够自行单独启动或销毁，拥有自己独立<br>的数据库。</li></ul><h1 id="微服务架构技术栈"><a href="#微服务架构技术栈" class="headerlink" title="微服务架构技术栈"></a>微服务架构技术栈</h1><table><thead><tr><th>微服务技术维度</th><th>技术实现</th></tr></thead><tbody><tr><td>服务开发</td><td>Spring Boot、Spring、Spring MVC等</td></tr><tr><td>服务注册与发现</td><td>Eureka、Zookeeper等</td></tr><tr><td>服务调用</td><td>Rest、RPC等</td></tr><tr><td>服务熔断器</td><td>Hystrix、Envoy等</td></tr><tr><td>负载均衡</td><td>Ribbon、Nginx等</td></tr><tr><td>服务接口调用(客户端调用服务的简化工具)</td><td>Feign等</td></tr><tr><td>消息队列</td><td>Kafka、ActiveMQ等</td></tr><tr><td>服务配置中心管理</td><td>Spring Cloud Config等</td></tr><tr><td>服务路由（API网关）</td><td>Zuul等</td></tr><tr><td>服务监控</td><td>Zabbix、Nagios等</td></tr><tr><td>全链路追踪</td><td>Zipkin，Brave等</td></tr><tr><td>服务部署</td><td>Docker、OpenStack等</td></tr><tr><td>数据流处理</td><td>Spring Cloud Stream（Redis,Rabbit,Kafka等发送接收消息）</td></tr><tr><td>事件消息总线</td><td>Spring Cloud Bus</td></tr><tr><td>…</td><td>…</td></tr></tbody></table></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.flyinghuster.com/pip&conda切换国内源/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="刘中岳"><meta itemprop="description" content="飞翔的Huster"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="The Flying Huster"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/pip&conda切换国内源/" class="post-title-link" itemprop="url">pip&amp;conda切换国内源</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-01-28 13:55:57" itemprop="dateCreated datePublished" datetime="2020-01-28T13:55:57+08:00">2020-01-28</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span title="Symbols count in article">0</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">1 mins.</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="需求背景"><a href="#需求背景" class="headerlink" title="需求背景"></a>需求背景</h1><p>在使用pip和conda管理工具管理python第三方库时，经常会遇到下载超时而引发的错误。因此，我们需要在必要的时候对软件源进行调整。</p><h1 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h1><h2 id="pip"><a href="#pip" class="headerlink" title="pip"></a>pip</h2><h3 id="单次切换国内原"><a href="#单次切换国内原" class="headerlink" title="单次切换国内原"></a>单次切换国内原</h3><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install packagename -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure><h3 id="修改配置文件位置"><a href="#修改配置文件位置" class="headerlink" title="修改配置文件位置"></a>修改配置文件位置</h3><p>windows配置文件目录：</p><p>文件路径：C:\Users\你的用户名\pip\pip.ini</p><p>*nix配置文件目录：<br>文件路径：~/.pip/pip.conf</p><p>将pip.ini或pip.conf内容修改如下：<br></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">global</span>]</span><br><span class="line"><span class="built_in">index</span>-url = http<span class="variable">s:</span>//pypi.tuna.tsinghua.edu.<span class="keyword">cn</span>/simple</span><br><span class="line">[install]</span><br><span class="line">trusted-host=pypi.tuna.tsinghua.edu.<span class="keyword">cn</span></span><br></pre></td></tr></table></figure><p></p><h2 id="conda"><a href="#conda" class="headerlink" title="conda"></a>conda</h2><h3 id="添加"><a href="#添加" class="headerlink" title="添加"></a>添加</h3><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels <span class="comment">#跟源站地址如https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span></span><br></pre></td></tr></table></figure><h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda config --remove-key channels</span><br></pre></td></tr></table></figure><h3 id="设置搜索时显示通道地址"><a href="#设置搜索时显示通道地址" class="headerlink" title="设置搜索时显示通道地址"></a>设置搜索时显示通道地址</h3><p>conda config –set show_channel_urls yes</p><h3 id="修改配置文件位置-1"><a href="#修改配置文件位置-1" class="headerlink" title="修改配置文件位置"></a>修改配置文件位置</h3><p>在~/.condarc中输入下列内容<br></p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">channels:</span><br><span class="line">  - https://mirrors.ustc.edu.cn/anaconda/pkgs/main/</span><br><span class="line">  - https://mirrors.ustc.edu.cn/anaconda/cloud/conda-forge/</span><br><span class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">  - defaults</span><br><span class="line">show_channel_urls: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p></p><h1 id="镜像源"><a href="#镜像源" class="headerlink" title="镜像源"></a>镜像源</h1><h2 id="pip源"><a href="#pip源" class="headerlink" title="pip源"></a>pip源</h2><table><thead><tr><th>源站</th><th>地址</th></tr></thead><tbody><tr><td>阿里云</td><td><a href="http://mirrors.aliyun.com/pypi/simple/" target="_blank" rel="noopener">http://mirrors.aliyun.com/pypi/simple/</a></td></tr><tr><td>中国科技大学</td><td><a href="https://pypi.mirrors.ustc.edu.cn/simple/" target="_blank" rel="noopener">https://pypi.mirrors.ustc.edu.cn/simple/</a></td></tr><tr><td>豆瓣(douban)</td><td><a href="http://pypi.douban.com/simple/" target="_blank" rel="noopener">http://pypi.douban.com/simple/</a></td></tr><tr><td>清华大学</td><td><a href="https://pypi.tuna.tsinghua.edu.cn/simple/" target="_blank" rel="noopener">https://pypi.tuna.tsinghua.edu.cn/simple/</a></td></tr><tr><td>中国科学技术大学</td><td><a href="http://pypi.mirrors.ustc.edu.cn/simple/" target="_blank" rel="noopener">http://pypi.mirrors.ustc.edu.cn/simple/</a></td></tr></tbody></table><h2 id="conda源"><a href="#conda源" class="headerlink" title="conda源"></a>conda源</h2><table><thead><tr><th>源站</th><th>地址</th></tr></thead><tbody><tr><td>清华</td><td><a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</a> <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge</a> <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/</a></td></tr><tr><td>中科大</td><td><a href="https://mirrors.ustc.edu.cn/anaconda/pkgs/main/" target="_blank" rel="noopener">https://mirrors.ustc.edu.cn/anaconda/pkgs/main/</a> <a href="https://mirrors.ustc.edu.cn/anaconda/pkgs/free/" target="_blank" rel="noopener">https://mirrors.ustc.edu.cn/anaconda/pkgs/free/</a> <a href="https://mirrors.ustc.edu.cn/anaconda/cloud/conda-forge/" target="_blank" rel="noopener">https://mirrors.ustc.edu.cn/anaconda/cloud/conda-forge/</a> <a href="https://mirrors.ustc.edu.cn/anaconda/cloud/msys2/" target="_blank" rel="noopener">https://mirrors.ustc.edu.cn/anaconda/cloud/msys2/</a> <a href="https://mirrors.ustc.edu.cn/anaconda/cloud/bioconda/" target="_blank" rel="noopener">https://mirrors.ustc.edu.cn/anaconda/cloud/bioconda/</a> <a href="https://mirrors.ustc.edu.cn/anaconda/cloud/menpo/" target="_blank" rel="noopener">https://mirrors.ustc.edu.cn/anaconda/cloud/menpo/</a></td></tr></tbody></table></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.flyinghuster.com/剑指Offer面试题[17]打印从1到最大的n位数/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="刘中岳"><meta itemprop="description" content="飞翔的Huster"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="The Flying Huster"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/剑指Offer面试题[17]打印从1到最大的n位数/" class="post-title-link" itemprop="url">剑指Offer面试题[17]打印从1到最大的n位数</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-01-19 12:42:43" itemprop="dateCreated datePublished" datetime="2020-01-19T12:42:43+08:00">2020-01-19</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据结构与算法/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span title="Symbols count in article">0</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">1 mins.</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="面试题17-打印从1到最大的n位数"><a href="#面试题17-打印从1到最大的n位数" class="headerlink" title="面试题17:打印从1到最大的n位数"></a>面试题17:打印从1到最大的n位数</h1><p>题目：输入数字n，按顺序打印从1到最大的n位十进制数。比如输入3，则打印出1、2、3一直到最大的3位数999.</p><h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><h2 id="典型错误解法"><a href="#典型错误解法" class="headerlink" title="典型错误解法"></a>典型错误解法</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PrintToMaxOfNDigits_1</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> number = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i++ &lt;n)</span><br><span class="line">        number*=<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;number; ++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\t"</span>, i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="在字符串上模拟数字加法"><a href="#在字符串上模拟数字加法" class="headerlink" title="在字符串上模拟数字加法"></a>在字符串上模拟数字加法</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PrintToMaxOfNDigits</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n&lt;=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">char</span>* number = <span class="keyword">new</span> <span class="keyword">char</span>[n+<span class="number">1</span>];</span><br><span class="line">    <span class="built_in">memset</span>(number, <span class="string">'0'</span>, n);</span><br><span class="line">    number[n]=<span class="string">'\0'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!Increcement(number))</span><br><span class="line">    &#123;</span><br><span class="line">        PrintNumber(number);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">delete</span> []number;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="递归解法"><a href="#递归解法" class="headerlink" title="递归解法"></a>递归解法</h2><p><code>`</code>c++<br>void PrintToMaxOfNDigits(int n)<br>{<br>if(n&lt;=0)<br>reutrn;<br>char* number = new char[n+1];<br>number[n]=’\0’;</p><pre><code>for(int i =0; i&lt;10; i++i)
{
    number[0]=i+&apos;0&apos;;
    PrintToMaxOfNDigitsRecursively(number, n, 0);
}
delete[] number;
</code></pre><p>}</p><p>void PrintToMaxOfNDigitsRecursively(char* number, int length, int index)<br>{<br>if(index == length -1)<br>{<br>PrintNumber(number);<br>return;<br>}</p><pre><code>for(int i = 0; i&lt;10; ++i)
{
    number[index+1]=i+&apos;0&apos;;
    PrintToMaxOfNDigitsRecursively(number, length, index+1);
}
</code></pre><p>}</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.flyinghuster.com/知识图谱推理技术研究进展/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="刘中岳"><meta itemprop="description" content="飞翔的Huster"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="The Flying Huster"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/知识图谱推理技术研究进展/" class="post-title-link" itemprop="url">知识图谱推理技术研究进展</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-01-15 11:14:33" itemprop="dateCreated datePublished" datetime="2020-01-15T11:14:33+08:00">2020-01-15</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/知识图谱/" itemprop="url" rel="index"><span itemprop="name">知识图谱</span></a></span> , <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/知识图谱/知识推理/" itemprop="url" rel="index"><span itemprop="name">知识推理</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span title="Symbols count in article">0</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">1 mins.</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>推理是用已有知识推断出未知知识的过程。知识推理是知识图谱中的一个重要环节。知识推理中的经典任务有知识补全、不一致性检测、知识问答等。</p><p>依据推理任务，推理的方法分为演绎推理、归纳推理以及设证推理。归纳推理是一个从特殊到一般的过程，通过对部分对象进行观察，从而推断整体对象具有的一些共性。而演绎推理则恰恰相反，演绎推理是一个从一半到特殊的过程，通过对整体对象进行观察，从而推断某一部分对象具有的一些特性。设证推理则是使用假设的理论区域经验相对照，以此来验证理论的正确性。<br>依据推理方法，推理的方法大致分为确定性推理和不确定推理。确定性推理也被称为逻辑推理，逻辑推理具有坚实的理论基础以及严格的推理过程，在专家预先定义好的规则约束下，逻辑推理可以准确的导出唯一的结论，也即逻辑推理的结论是固定的，其中典型的逻辑推理方法有可被用于一阶逻辑推理的基于前向连接的rete算法；可被用于求解命题逻辑推理的GSAT和WALKSAT算法。不确定推理也被称为概率推理，不确定性不严格按照既定规则去进行推理，而是使用统计学习等手段，根据已有经验，按照一定模式去构建概率模型。其中典型的概率推理方法有：概率图模型、概率逻辑推理以及关联规则挖掘。</p><p>依据推理形式，推理的方法大致分为符号推理和数值推理。基于知识图谱的符号推理直接在知识图谱中的试题和关系符号上进行推理操作，因此，符号推理也可被看作是逻辑推理。数值推理是使用数值，张量等数值计算方法以挖掘知识图谱上的隐藏特征，并以此来模拟推理过程。<br>面向知识图谱的推理主要围绕关系的推理展开，这就需要构建的知识图谱具有根据已有的事实或关系推断出未知的事实或关系的能力。目前，知识图谱的主要技术手段按推理任务可以分为两类：基于演绎的知识图谱推理与基于归纳的知识图谱推理，下面我们从演绎与归纳的观点出发，对主流推理技术进行介绍。图1展示了知识图谱推理技术研究进展。</p><p><img src="/知识图谱推理技术研究进展/知识图谱推理.jpg" alt="图1：知识图谱推理技术研究进展"></p><h1 id="基于演绎的知识图谱推理技术"><a href="#基于演绎的知识图谱推理技术" class="headerlink" title="基于演绎的知识图谱推理技术"></a>基于演绎的知识图谱推理技术</h1><p>基于演绎的知识图谱推理技术主要包括：本体推理方法、基于逻辑编程的推理方法，基于查询重写的方法和基于产生规则的方法。</p><h1 id="基于归纳的知识图谱推理技术"><a href="#基于归纳的知识图谱推理技术" class="headerlink" title="基于归纳的知识图谱推理技术"></a>基于归纳的知识图谱推理技术</h1><p>基于演绎的知识图谱推理技术主要包括：基于图结构的推理、基于规则学习的推理，基于表示学习的推理。</p><p>基于图结构的推理通过将知识图谱看做是有向图，利用图论相关算法来进行知识图谱推理。其中经典的基于图结构的推理算法有Path Ranking Algorithm，该算法通过使用该实体节点之间的路径作为特征以进行链路检测推理。</p><p>基于规则学习的推理，通过领域专家实现定义的规则，来进行推理。但是由于规则主要由领域专家提供，故而规则推理在大规模知识图谱的应用中十分局限，这主要是由于领域专家啊提供规则的效率比较低且知识图谱动态变化的特性导致的。为了克服这个困难，专家们提出了自动化的规则学习方法。其中经典的自动化规则学习算法有AMIE，AMIE是一种霍恩规则，通过SPARQL在知识图谱上的查询对规则的质量进行评估，从而对规则库进行自动化管理。</p><p>基于表示学习通过将知识图谱中包含实体和关系的元素映射到一个连续的向量空间中，从而使是的知识图谱可以使用预设的向量空间表示之间的计算方法来进行知识推理。其中经典的基于表示学习方法有：TransE，ConvE模型等。</p><h1 id="新兴的知识图谱推理技术"><a href="#新兴的知识图谱推理技术" class="headerlink" title="新兴的知识图谱推理技术"></a>新兴的知识图谱推理技术</h1><p>随着人工智能、大数据技术的快速发展以及科员人员对于知识图谱研究的进一步深入，出现了更先进的知识图谱推理技术。其中，以时序预测推理方法，基于强化学习的知识图谱推理方法、基于元学习的少样本知识图谱推理方法以及图神经网络与基于图神经网络的知识图谱推理方法等在知识推理方面有着广阔的应用与研究前景。下面，我们对这四种新兴知识图谱推理技术进行介绍。</p><p>时序预测推理方法扩展了传统机器学习中的特征嵌入应用范围，使其可用于本体语义嵌入，通过将语义推理和及其学习相结合以捕获本体流中的一致性和知识蕴含的向量，然后再有监督的刘学习的上下文中使用这种嵌入来进行学习。这种方法训练出的模型具有稳定性，通用性与灵活性的特点，它可以增强基本的刘学习算法。</p><p>基于强化学习的知识图谱推理技术在“查询问答”的推理任务上具有良好的性能，当知识图路径较长时，使用强化学习出的模型依然具有很高的准确率与可接受的效率。</p><p>基于元学习的少样本知识图谱推理方法近年来被用来解决知识图谱中有关肠胃关系的推理。</p><p>基于图神经网络的知识图谱推理技术，由于图神经网络的引入极大地扩展了知识库中试题和关系元素的表达，在并具有一定的推理能力，在表示学习和推理方面有着可预见的广泛的应用前景。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.flyinghuster.com/使用MapReduce实现倒排索引/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="刘中岳"><meta itemprop="description" content="飞翔的Huster"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="The Flying Huster"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/使用MapReduce实现倒排索引/" class="post-title-link" itemprop="url">使用MapReduce实现倒排索引</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-01-10 02:03:42" itemprop="dateCreated datePublished" datetime="2020-01-10T02:03:42+08:00">2020-01-10</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/分布式系统/" itemprop="url" rel="index"><span itemprop="name">分布式系统</span></a></span> , <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/分布式系统/MapReduce/" itemprop="url" rel="index"><span itemprop="name">MapReduce</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span title="Symbols count in article">0</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">1 mins.</span></div></div></header><div class="post-body" itemprop="articleBody"><p>任务描述<br>本关任务：编写 MapReduce 实现倒排索引。</p><p>相关知识<br>什么是MapReduce<br>MapReduce 是一种可用于数据处理的编程模型，我们现在设想一个场景，你接到一个任务，任务是：挖掘分析我国气象中心近年来的数据日志，该数据日志大小有 3T ，让你分析计算出每一年的最高气温，如果你现在只有一台计算机，如何处理呢？我想你应该会读取这些数据，并且将读取到的数据与目前的最大气温值进行比较。比较完所有的数据之后就可以得出最高气温了。不过以我们的经验都知道要处理这么多数据肯定是非常耗时的。</p><p>如果我现在给你三台机器，你会如何处理呢？看到下图你应该想到了：最好的处理方式是将这些数据切分成三块，然后分别计算处理这些数据（ Map ），处理完毕之后发送到一台机器上进行合并（ merge ），再计算合并之后的数据，归纳（ reduce ）并输出。</p><p>这就是一个比较完整的 MapReduce 的过程了。</p><p><img src="/使用MapReduce实现倒排索引/1.jpg" alt></p><p>如何使用MapReduce进行运算<br>我们通过一个示例，来体验 Map/Reduce 的使用。</p><p>我们从一个问题入手：目前我们想统计两个文本文件中，每个单词出现的次数。</p><p>首先我们在当前目录下创建两个文件：</p><p>创建file01输入内容：</p><p>Hello World Bye World<br>创建file02输入内容：</p><p>Hello Hadoop Goodbye Hadoop<br>将文件上传到 HDFS 的/usr/input/目录下：</p><p>不要忘了启动 DFS：</p><p>start-dfs.sh</p><p>然后创建文件夹并上传：</p><p><img src="/使用MapReduce实现倒排索引/2.jpg" alt></p><p>在右侧代码区域编写，文件WordCount.java，添加如下内容：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordCount</span> &#123;</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenizerMapper</span> </span></span><br><span class="line"><span class="class">       <span class="title">extends</span> <span class="title">Mapper</span>&lt;LongWritable, Text, Text, IntWritable&gt;&#123;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> IntWritable one = <span class="keyword">new</span> IntWritable(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">private</span> Text <span class="keyword">word</span> = <span class="keyword">new</span> Text();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(LongWritable key, Text value, Context context</span></span></span><br><span class="line">                    ) throws IOException, InterruptedException &#123;</span><br><span class="line">      StringTokenizer itr = <span class="keyword">new</span> StringTokenizer(value.toString());</span><br><span class="line">      <span class="keyword">while</span> (itr.hasMoreTokens()) &#123;</span><br><span class="line">        <span class="keyword">word</span>.<span class="built_in">set</span>(itr.nextToken());</span><br><span class="line">        context.<span class="built_in">write</span>(<span class="keyword">word</span>, one);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntSumReducer</span> </span></span><br><span class="line"><span class="class">       <span class="title">extends</span> <span class="title">Reducer</span>&lt;Text,IntWritable,Text,IntWritable&gt; &#123;</span></span><br><span class="line">    <span class="keyword">private</span> IntWritable result = <span class="keyword">new</span> IntWritable();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values, </span></span></span><br><span class="line"><span class="function"><span class="params">                       Context context</span></span></span><br><span class="line">                       ) throws IOException, InterruptedException &#123;</span><br><span class="line">      <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (IntWritable val : values) &#123;</span><br><span class="line">        sum += val.<span class="built_in">get</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      result.<span class="built_in">set</span>(sum);</span><br><span class="line">      context.<span class="built_in">write</span>(key, result);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span> throws Exception </span>&#123;</span><br><span class="line">    Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">    Job job = <span class="keyword">new</span> Job(conf, <span class="string">"word count"</span>);</span><br><span class="line">    job.setJarByClass(WordCount.class);</span><br><span class="line">    job.setMapperClass(TokenizerMapper.class);</span><br><span class="line">    job.setCombinerClass(IntSumReducer.class);</span><br><span class="line">    job.setReducerClass(IntSumReducer.class);</span><br><span class="line">    job.setOutputKeyClass(Text.class);</span><br><span class="line">    job.setOutputValueClass(IntWritable.class);</span><br><span class="line">    <span class="keyword">String</span> inputfile = <span class="string">"/usr/input"</span>;</span><br><span class="line">    <span class="keyword">String</span> outputFile = <span class="string">"/usr/output"</span>;</span><br><span class="line">    FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(inputfile));</span><br><span class="line">    FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(outputFile));</span><br><span class="line">    System.<span class="built_in">exit</span>(job.waitForCompletion(<span class="literal">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>点击评测，运行代码，可以看到/usr/output目录下已经生成了文件。</p><p><img src="/使用MapReduce实现倒排索引/3.jpg" alt></p><p>我们来查看part–r-00000文件的内容：</p><p><img src="/使用MapReduce实现倒排索引/4.jpg" alt></p><p>可以看到统计的数据已经生成在文件中了。</p><p>如果你还想要运行一次，那么你需要删除输出路径的文件夹和文件。</p><p>代码解释<br>示例中，Map/Reduce 程序总共分为三块即：Map，Reduce，Job，Map 负责处理输入文件的内容。</p><p>TokenizerMapper 的 map 方法，它通过 StringTokenizer 以空格为分隔符将一行切分为若干 tokens ，之后，输出 &lt; , 1&gt; 形式的键值对。</p><p>对于示例中的第一个输入， map 输出是：</p><p>&lt; Hello, 1&gt;</p><p>&lt; World, 1&gt;</p><p>&lt; Bye, 1&gt;</p><p>&lt; World, 1&gt;</p><p>第二个输入，map 输出是：</p><p>&lt; Hello, 1&gt;</p><p>&lt; Hadoop, 1&gt;</p><p>&lt; Goodbye, 1&gt;</p><p>&lt; Hadoop, 1&gt;</p><p>WordCount 还指定了一个 combiner 。因此，每次 map 运行之后，会对输出按照 key 进行排序，然后把输出传递给本地的 combiner （按照作业的配置与 Reducer 一样），进行本地聚合。</p><p><img src="/使用MapReduce实现倒排索引/5.jpg" alt></p><p>第一个 map 的输出是：</p><p>&lt; Bye, 1&gt;</p><p>&lt; Hello, 1&gt;</p><p>&lt; World, 2&gt;</p><p>第二个 map 的输出是：</p><p>&lt; Goodbye, 1&gt;</p><p>&lt; Hadoop, 2&gt;</p><p>&lt; Hello, 1&gt;</p><p>reduce 收到的数据是这样的：</p><p>&lt; Bye , [1]&gt;</p><p>&lt; GoodBye , [1]&gt;</p><p>&lt; Hadoop , [1,1]&gt;</p><p>&lt; Hello , [1,1]&gt;</p><p>&lt; World , [1,1]&gt;</p><p>Reducer 中的 reduce 方法 仅是将每个 key（本例中就是单词）出现的次数求和。</p><p>因此这个作业的输出就是：</p><p>&lt; Bye, 1&gt;</p><p>&lt; Goodbye, 1&gt;</p><p>&lt; Hadoop, 2&gt;</p><p>&lt; Hello, 2&gt;</p><p>&lt; World, 2&gt;</p><p>编程要求<br>根据提示，在右侧编辑器的中的 begin-end 间补全 InvertIndex_origin 类中的 map 和 reduce 函数。具体实现如下。</p><p>读取 hdfs 中/input目录下的如下三个文件，文件内容如下：</p><p>file1.txt内容：</p><p>mapreduce is simple</p><p>file2.txt内容：</p><p>mapreduce is powerful and simple</p><p>file3.txt内容：</p><p>mapreduce and mapreduce<br>使用 mapreduce 处理后把结果输出到 hdfs 的/out目录下，预期输出内容如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">and file3.txt:1;file2.txt:1;</span><br><span class="line">is file2.txt:1;file1.txt:1;</span><br><span class="line">mapreduce file1.txt:1;file2.txt:1;file3.txt:2;</span><br><span class="line">powerful file2.txt:1;</span><br><span class="line">simple file2.txt:1;file1.txt:1;</span><br><span class="line">后台会自动把代码打包并执行以下命令提交：</span><br></pre></td></tr></table></figure><p>hadoop jar /root/invertedindex-1.0-SNAPSHOT.jar InvertIndex_origin /invertindex /out</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.flyinghuster.com/现代计算机网络复习笔记/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="刘中岳"><meta itemprop="description" content="飞翔的Huster"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="The Flying Huster"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/现代计算机网络复习笔记/" class="post-title-link" itemprop="url">现代计算机网络复习笔记</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2020-01-03 16:22:48" itemprop="dateCreated datePublished" datetime="2020-01-03T16:22:48+08:00">2020-01-03</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/计算机网络/" itemprop="url" rel="index"><span itemprop="name">计算机网络</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span title="Symbols count in article">0</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">1 mins.</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h1><h2 id="Ch1-1-体系结构"><a href="#Ch1-1-体系结构" class="headerlink" title="Ch1-1 体系结构"></a>Ch1-1 体系结构</h2><ol><li><p>网络的基本概念</p><p> 逻辑链路：<br> 在两点间通过通信协议的作用建立起来的数据联结通路<br> 通路(Path):<br> 从源点到宿点所经过的一串节点和链路的有序集。或端到端的通路<br> 协议（Protocol）<br> 多个进程为完成一个任务而共同遵守的动作序列规范<br> 三要素：语法、语义、规则(同步时序)<br> 网络云：<br> 区分通信子网交换交换结点（云内）和资源主机结点（云外）的分界<br>线，可表示任何网络（单、多、交换等）</p><p> 第一层：Backbone中转网：国家或世界级网络主干<br>美NFSnet/欧Ebone/中Chinanet/CERNET<br> 第二层：Transit地区性网：覆盖省、洲、国家,<br>提供到因特网的连接<br>因特网服务提供者ISP<br> 第三层：Stub组织性网：本地服务提供商；<br>是一个自治网络系统，有AS号<br>校园网、企业网、公司网、政府网<br>由外围网关接入地区性网络</p></li><li><p>性能参数<br> 性能测量的两个参数：带宽和延迟<br> 带宽(Bandwidth):Hz,KHz,MHz,GHz，bps<br> 信号带宽：构成一信号的各种不同频率成分所占据的频率范围。如人类声音<br>带宽为：3300Hz－300＝声音带宽3000Hz<br> 媒体带宽：通信媒体允许通过的信号频带范围<br> 比特率：某时段内网络上可能传输的比特数，或传输每比特数据所需的时间<br>宽度。习惯把“带宽”作为数字信道的数据率或比特率<br> 比特率越高，高频分量越多，频率范围越大，信号带宽越高。<br> 吞吐率(Throughput)：bps<br> 数字信号的发送速率，因此发送带宽也成为吞吐率<br> 由于各种影响 10M 带宽实际完成 2Mbps<br> 吞吐率：链路上实际每秒传输的比特数</p></li></ol><pre><code>延迟：
 Delay : 把一个报文从网络一端传输到另一端所需的时间one way，光传播
速度：
 3.0x108m/s ;光在真空内传播的速率
 2.8x108m/s ;电在Cable内传播的速率
 2.0x108m/s ;光在Fiber内传播的速率
 Round Trip Time (RTT):发收来回时间（2次时延）
 定义：延迟 = 处理＋排队+传输+传播，主要考虑后两个
 处理时延：检查包首部、决定导向何处；比特差错检测，高速Router一般在微秒
或更低数量级，接收完整的一个分组的时间＝包容量/链路速率
 排队时延：等待输出链路空闲，与当时流量和排队规则有关
 传输时延：数据量/带宽；微秒到毫秒级
 传播时延：距离/光速(光缆中1000km传播延迟约5ms) 广域网在毫秒级

 端到端吞吐率 = 实际传输
大小/传输时间
 实际传输时间 = RTT+ 传输
大小/信道带宽
 RTT：请求与回答时间
</code></pre><p> 问题：信道带宽1Gbps，一端到另一端传播时<br>延τ= 10ms，TCP发送窗口65535字节。问可<br>能达到的最大吞吐率T ？信道利用率ρ？<br> 解析：T= size/(2τ+size/BW)<br> = size<em>BW/(2τ</em>BW+size) bps<br> = 65535<em>8</em>109/(20<em>109</em>10-3s+65535<em>8)bps<br> = 524280</em>103/(20 *106 +524280)Mbps<br> = 25.5 Mbps，ρ=25.5M/1000M=2.55%</p><p> 带宽和延迟的组合可描述链路或信道的特征，其相对重<br>要性取决于具体的应用<br> 有些应用延迟支配带宽（SSH），如端客户发送1字节到服务器<br>并依次收到1字节就是延迟重要，如果响应中没有大量的计算，<br>由于跨洲信道要100ms的RTT，同一房间内仅1ms RTT，所以不<br>同延迟导致完全不同效果<br> 数字图书馆来说是带宽支配延迟。设带宽10Mbps,则需<br>20s(2.5MByte的一个图片)，信道是1ms或者100ms延迟不重要，<br>20.001s和20.1s之差可略</p><p>延迟带宽积（以太网相关参数）<br> 一对进程通道间的延迟(总体延迟)带宽积：信道管道的体积=链路上所<br>容纳的比特数<br> 一个信道延迟=50ms ,带宽45Mbps, 则能容纳=50ms<em> 45Mbps=50</em>10-<br>3 sec*45Mbits/sec =2.25Mbits<br> 等价于信道上同时可以存在281K个Byte信号（2.25M/8）</p><ol start="3"><li>习题<br> 假设在地球和月球间建立一点对点100MPS的连接，地<br>月距离为385,000KM，数据传播速度为光速（3<em>108<br>M/S）<br> A．计算最小的RTT<br> B．use the RTT as the delay , calculate the delay</em>bandwidth<br>product for the link<br> C. 在B中计算的delay*bandwidth有何意义？<br> D．在月球照的照片，并以数字格式存在磁盘上。如果地球上的<br>控制中心想下载25M的最新的图形，那么从发出数据到传输完成<br>所要的最小时间是多少？</li></ol><h2 id="Ch1-2-直连网络技术"><a href="#Ch1-2-直连网络技术" class="headerlink" title="Ch1-2 直连网络技术"></a>Ch1-2 直连网络技术</h2><h2 id="Ch1-3-报文交换"><a href="#Ch1-3-报文交换" class="headerlink" title="Ch1-3 报文交换"></a>Ch1-3 报文交换</h2><h2 id="Ch1-4-TCP-IP网络技术"><a href="#Ch1-4-TCP-IP网络技术" class="headerlink" title="Ch1-4 TCP/IP网络技术"></a>Ch1-4 TCP/IP网络技术</h2><h1 id="第二章-IPv6"><a href="#第二章-IPv6" class="headerlink" title="第二章 IPv6"></a>第二章 IPv6</h1><ol><li><p>IPv4和IPv6差异？</p></li><li><p>IPv6地址分类和特点</p></li><li><p>IPv6地址自动分配两种方式, stateless过程</p></li><li><p>IPv6邻居发现协议中：地址解析和DAD</p></li><li><p>IPSec基本概念</p></li></ol><h1 id="第三章-拥塞控制"><a href="#第三章-拥塞控制" class="headerlink" title="第三章 拥塞控制"></a>第三章 拥塞控制</h1><ol><li>拥塞控制基本概念</li></ol><ul><li>Power=吞吐率/延迟</li><li>公平的定义</li></ul><ol start="2"><li>排队算法： FIFO, fQ, wfq</li><li>流量整形：漏桶、令牌桶算法（PPT习题）</li><li>TCP拥塞控制机制（慢启动、拥塞避免、快乘船、快速回复）</li><li>拥塞避免：ECN，RED，TCP Veges算法</li></ol><h1 id="第四章-P2P"><a href="#第四章-P2P" class="headerlink" title="第四章 P2P"></a>第四章 P2P</h1><ol><li>三代P2P网络之间的定义和差异是什么？</li></ol><ul><li>第一代：混合式P2P网络（第一代）</li></ul><p> 拓扑结构：服务器仍然是网络的核心<br> 底层协议：全部使用TCP，限制了链接的Peer数量<br> 查询与路由简单高效：<br> Napster和BT的用户访问服务器；服务器返回文件索引或种子文件<br>；用户再直接同另一Peer连接<br> 故路由跳数为O(1)，即常数跳<br> 容错、自适应和匿名性<br> 服务器单点失效率高<br> 自组织和自适应主要依靠服务器<br> 服务器的存在使匿名性实际不可能<br> 用户接入无安全认证机制</p><ol><li>Napster和Gnutella的原理</li></ol><ul><li>第二代：非结构化P2P网络（第二代）</li></ul><ul><li>第三代：结构化P2P网络(第三代)</li></ul><ol><li>掌握Chord协议</li></ol><ol start="2"><li>理解Kademlia的原理，例如Kademlia协议是如何找到资源的</li></ol><ol start="3"><li>掌握Bitcoin原理（论文）以及区块链概念</li></ol></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.flyinghuster.com/现代计算机网络lab03-TCP Congestion性能测试分析/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="刘中岳"><meta itemprop="description" content="飞翔的Huster"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="The Flying Huster"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/现代计算机网络lab03-TCP Congestion性能测试分析/" class="post-title-link" itemprop="url">现代计算机网络lab03-TCP Congestion性能测试分析</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2019-12-21 13:23:31" itemprop="dateCreated datePublished" datetime="2019-12-21T13:23:31+08:00">2019-12-21</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/计算机网路/" itemprop="url" rel="index"><span itemprop="name">计算机网路</span></a></span> , <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/计算机网路/性能分析/" itemprop="url" rel="index"><span itemprop="name">性能分析</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span title="Symbols count in article">0</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">1 mins.</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="GNS3下的TCP-Congestion测试"><a href="#GNS3下的TCP-Congestion测试" class="headerlink" title="GNS3下的TCP Congestion测试"></a>GNS3下的TCP Congestion测试</h1><p>在GNS3中创建一个新项目，用三台SEED虚拟机按照如图方式连接起来(参考实验1，三台虚拟机分别为SEEDClient，SEED-Router，SEED-Server)，配置IP地址，让他们可以互相通信 如果物理机器性能一般，请用slitaz代替<br>SEED，不过必须自己安装一些软件，安装软件参考： slitaz文档：<a href="http://doc.slitaz.org" target="_blank" rel="noopener">http://doc.slitaz.org</a></p><p><img src="/现代计算机网络lab03-TCP Congestion性能测试分析/1.jpg" alt><br>注意的地方： 在GNS3中先给每台虚拟机配置三个网卡：</p><p><img src="/现代计算机网络lab03-TCP Congestion性能测试分析/2.jpg" alt></p><p>eth0网卡不要在GNS3中使用，而是用VirtualBox如下配置：</p><p><img src="/现代计算机网络lab03-TCP Congestion性能测试分析/3.jpg" alt><br>可以发现虚拟机可以同时访问外部网络<br>在SEED-Client和SEED-Server上安装iperf软件</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install iperf</span><br></pre></td></tr></table></figure><h1 id="Linux下的TCP拥塞控制算法"><a href="#Linux下的TCP拥塞控制算法" class="headerlink" title="Linux下的TCP拥塞控制算法"></a>Linux下的TCP拥塞控制算法</h1><ul><li>列出所有直接编译到内核的拥塞控制算法：<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sysctl net.ipv4.tcp_available_congestion_control</span><br><span class="line">cubic reno</span><br></pre></td></tr></table></figure></li></ul><p><img src="/现代计算机网络lab03-TCP Congestion性能测试分析/4.jpg" alt></p><ul><li><p>修改当前的拥塞控制算法：</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.tcp_congestion_control=cubic</span><br></pre></td></tr></table></figure></li><li><p>增加新的拥塞控制算法： linux支持的拥塞控制算法：</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><p>怎么加载这些内核模块，来运行新的拥塞控制算法：<br></p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#echo "westwood" &gt; /proc/sys/net/ipv4/tcp_congestion_control</span></span><br><span class="line"><span class="comment">#cat /proc/sys/net/ipv4/tcp_congestion_control</span></span><br><span class="line">westwood</span><br></pre></td></tr></table></figure><p></p><p>或者：<br></p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#echo "westwood" &gt; /proc/sys/net/ipv4/tcp_congestion_control</span></span><br><span class="line"><span class="comment">#lsmod | grep westwood</span></span><br><span class="line">tcp_westwood 12675 0</span><br></pre></td></tr></table></figure><p></p><p>各种拥塞控制算法简介：</p><ul><li>High Speed TCP<br>The algorithm is described in RFC 3649. The main use is for connections with large<br>bandwidth and large RTT (such as Gbit/s and 100 ms RTT).</li><li>H-TCP<br>H-TCP was proposed by the Hamilton Institute for transmissions that recover more<br>quickly after a congestion event. It is also designed for links with high bandwidth and<br>RTT.</li><li>Scalable TCP<br>This is another algorithm for WAN links with high bandwidth and RTT. One of its design<br>goals is a quick recovery of the window size after a congestion event. It achieves this<br>goal by resetting the window to a higher value than standard TCP.<br>3.从SEED-Client虚拟机发包测试<br>下面以SEED-Client和SEED-Server都设置拥塞算法为cubic<br>先在SEED-Server端运行下面的命令，让iperf的服务器端运行守护在5001端口：<br>在SEED-Client端运行下面的命令，让iperf的客户端运行，同时利用Linux内核的tcp probe模块监控特定连接中参<br>数变化：</li><li>TCP BIC<br>BIC is the abbreviation for Binary Increase Congestion control. BIC uses a unique<br>window growth function. In case of packet loss, the window is reduced by a<br>multiplicative factor. The window size just before and after the reduction is then used<br>as parameters for a binary search for the new window size. BIC was used as standard<br>algorithm in the Linux kernel.</li><li>TCP CUBIC<br>CUBIC is a less aggressive variant of BIC (meaning, it doesn’t steal as much throughput<br>from competing TCP flows as does BIC).</li><li>TCP Hybla<br>TCP Hybla was proposed in order to transmit data efficiently over satellite links and<br>“defend” the transmission against TCP flows from other origins.</li><li>TCP Low Priority<br>This is an approach to develop an algorithm that uses excess bandwidth for TCP flows.<br>It can be used for low priority data transfers without “disturbing” other TCP<br>transmissions (which probably don’t use TCP Low Priority).</li><li>TCP Tahoe/Reno<br>These are the classical models used for congestion control. They exhibit the typical<br>slow start of transmissions. The throughput increases gradually until it stays stable.<br>It is decreased as soon as the transfer encounters congestion, then the rate rises<br>again slowly. The window is increased by adding fixed values. TCP Reno uses a<br>multiplicative decrease algorithm for the reduction of window size. TCP Reno is the<br>most widely deployed algorithm.</li><li>TCP Vegas<br>TCP Vegas introduces the measurement of RTT for evaluating the link quality. It uses<br>additive increases and additive decreases for the congestion window.</li><li>TCP Veno<br>This variant is optimised for wireless networks, since it was designed to handle random<br>packet loss better. It tries to keep track of the transfer, and guesses if the quality<br>decreases due to congestion or random packet errors.</li><li>TCP Westwood+<br>Westwood+ addresses both large bandwidth/RTT values and random packet loss together<br>with dynamically changing network loads. It analyses the state of the transfer by<br>looking at the acknowledgement packets. Westwood+ is a modification of the TCP Reno<br>algorithm.</li></ul><h1 id="从SEED-Client虚拟机发包测试"><a href="#从SEED-Client虚拟机发包测试" class="headerlink" title="从SEED-Client虚拟机发包测试"></a>从SEED-Client虚拟机发包测试</h1><p>下面以SEED-Client和SEED-Server都设置拥塞算法为cubic<br>先在SEED-Server端运行下面的命令，让iperf的服务器端运行守护在5001端口：<br></p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># iperf -s</span></span><br></pre></td></tr></table></figure><p></p><p>在SEED-Client端运行下面的命令，让iperf的客户端运行，同时利用Linux内核的tcp probe模块监控特定连接中参<br>数变化：</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># modprobe tcp_probe port=5001 //对端口为5001（源或目的）的tcp连接进行监控</span></span><br><span class="line"><span class="comment"># cat /proc/net/tcpprobe &gt; data.txt &amp; // tcpprobe捕捉的信息是持续性的，可以放到后台读</span></span><br><span class="line"><span class="comment"># pid=$! // 保存上一个读命令的pid，用于结束读tcpprobe接口</span></span><br><span class="line"><span class="comment"># iperf -c otherhost // 使用iperf建立一个TCP流</span></span><br><span class="line"><span class="comment"># kill $pid</span></span><br></pre></td></tr></table></figure><p>在文件data.txt中保存了tcp的拥塞窗口变化情况，可以通过虚拟机共享目录或者网络导出，作为实验数据，iperf运<br>行结果：<br><img src="/现代计算机网络lab03-TCP Congestion性能测试分析/5.jpg" alt></p><p>记录在data.out中的数据大致是这个样子：</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">11.172120204 193.168.0.2:8089 193.168.0.25:54320 32 0x842ccad 0x84299c5 10 168 14608</span><br><span class="line">143</span><br></pre></td></tr></table></figure><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">每行的各列分别为：</span><br></pre></td></tr></table></figure><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">timestamp //时间戳</span><br><span class="line">saddr:port // 源IP及端口，我的数据是在发送端捕捉的，所以port是固定的8089</span><br><span class="line">daddr:port // 目的IP及端口</span><br><span class="line">skb-&gt;len // 收到的数据包skb大小，收到的都是ACK包，所以len都比较小。</span><br><span class="line">snd_nxt // 下一个待发送数据的序列号</span><br><span class="line">snd_una // 待确认数据的序列号</span><br><span class="line">snd_cwnd // 拥塞窗口大小</span><br><span class="line">ssthresh // 慢启动阈值</span><br><span class="line">snd_wnd // 接收窗口大小</span><br><span class="line">srtt // smoothed RTT</span><br></pre></td></tr></table></figure><p>实际的例子，看到拥塞窗口线性增加：<br><img src="/现代计算机网络lab03-TCP Congestion性能测试分析/6.jpg" alt><br>看到拥塞窗口线性减少，ssthresh折半回退（跟特定的拥塞控制算法相关例如Vegas）：<br><img src="/现代计算机网络lab03-TCP Congestion性能测试分析/7.jpg" alt></p><h1 id="增加延迟"><a href="#增加延迟" class="headerlink" title="增加延迟"></a>增加延迟</h1><p>可以在SEED-Router这台虚拟机连接SEED-Server网卡上增加延迟和丢包来改变网络环境，利用的是Linux中的<br>iproute 工具，以及内核中的Network Simulator特性：</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tc qdisc change dev eth0 root netem loss 2.5%</span></span><br><span class="line">设置丢包</span><br><span class="line"><span class="comment"># tc qdisc add dev eth0 root netem delay 30ms 10ms</span></span><br><span class="line">设置延迟</span><br><span class="line"><span class="comment"># tc qdisc add dev eth0 root netem duplicate 1%</span></span><br><span class="line">该命令将 eth0 网卡的传输设置为随机产生 1% 的重复数据包</span><br><span class="line"><span class="comment"># tc qdisc add dev eth0 root netem corrupt 0.2%</span></span><br><span class="line">该命令将 eth0 网卡的传输设置为随机产生 0.2% 的损坏的数据包</span><br><span class="line">删除网卡上面的相关配置，将之前命令中的 add 改为 del 即可删除配置</span><br></pre></td></tr></table></figure><p>qdisc表示在网卡上的排队策略，可以通过ifconfig命令查看：</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@dl:~<span class="comment"># ip link show</span></span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,PROMISC,UP&gt; mtu 1500 qdisc pfifo_fast qlen 100</span><br><span class="line">link/ether 52:54:00:de:bf:19 brd ff:ff:ff:ff:ff:ff</span><br></pre></td></tr></table></figure><p>qdisc支持的排队策略包括：</p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">FIFO - simple FIFO (packet (p-FIFO) or byte (b-FIFO) )</span><br><span class="line">PRIO - n-band strict priority scheduler</span><br><span class="line">TBF - token bucket filter</span><br><span class="line">CBQ - class based queue</span><br><span class="line">CSZ - Clark-Scott-Zhang</span><br><span class="line">SFQ - stochastic fair queue</span><br><span class="line">RED - random early detection</span><br><span class="line">GRED - generalized random early detection</span><br><span class="line">TEQL - traffic equalizer</span><br><span class="line">ATM - asynchronous transfer mode</span><br><span class="line">DSMARK - DSCP (Diff-Serv Code Point)marker/remarker</span><br></pre></td></tr></table></figure><p>如果条件所限，还可以利用Linux防火墙来进行丢包，在Router上运行以下命令，实现0.5%的丢包<br></p><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -s 121.14.48.1 -m statistic --mode random --probability 0.005 -j DROP</span><br></pre></td></tr></table></figure><p></p><h1 id="实验要求"><a href="#实验要求" class="headerlink" title="实验要求"></a>实验要求</h1><p>根据以上网络配置和TCP性能测试方案，改变Router的延迟和丢包来测试TCP拥塞控制算法的性能：</p><ol><li>选择Linux内核支持的三种拥塞控制算法</li><li>针对每种拥塞控制算法进行性能测试，在性能测试中改变SEED-Router的丢包率和延迟，得到不同的性能测试<br>结果，记录测试结果</li><li>如果性能不行，换成slitaz虚拟机测试（需要编译内核）</li><li>对实验结果进行分析和比较</li></ol></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.flyinghuster.com/现代计算机网络lab02-实验报告/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="刘中岳"><meta itemprop="description" content="飞翔的Huster"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="The Flying Huster"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/现代计算机网络lab02-实验报告/" class="post-title-link" itemprop="url">现代计算机网络lab02-实验报告</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2019-12-07 06:21:21" itemprop="dateCreated datePublished" datetime="2019-12-07T06:21:21+08:00">2019-12-07</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/计算机网络/" itemprop="url" rel="index"><span itemprop="name">计算机网络</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span title="Symbols count in article">0</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">1 mins.</span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="环境（详细说明实验运行的操作系统，网络平台，机器的配置）"><a href="#环境（详细说明实验运行的操作系统，网络平台，机器的配置）" class="headerlink" title="环境（详细说明实验运行的操作系统，网络平台，机器的配置）"></a>环境（详细说明实验运行的操作系统，网络平台，机器的配置）</h2><p>操作系统：Windows 10 64bit Pro 1909</p><p>处理器：Intel® Xeon® CPU E3-1505M v6 \@ 3.00GHz</p><p>内存：DDR4 2666MHZ 24GB ECC</p><p>网络平台：GNS3 2.2.3</p><p>虚拟机软件：Oracle VM VirtualBox 6.0.14</p><p>虚拟机：Ubuntu 16.04 32bit</p><h2 id="实验目的"><a href="#实验目的" class="headerlink" title="实验目的"></a>实验目的</h2><ol><li><p>学会利用GNS3网络平台搭建网络拓扑结构并配置主机的IP和路由。</p></li><li><p>掌握SYN flood攻击的基本原理，利用虚拟机实现SYN flood攻击。</p></li><li><p>掌握SYN cookie的原理，并通过实验证明SYN cookie机制的有效性。</p></li><li><p>了解Linux内核TCP SYN Cookie机制，掌握查看与修改方法。</p></li></ol><div class="post-button text-center"><a class="btn" href="/现代计算机网络lab02-实验报告/#more" rel="contents">Read more &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.flyinghuster.com/剑指Offer面试题[16]数值的整数次方/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="刘中岳"><meta itemprop="description" content="飞翔的Huster"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="The Flying Huster"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/剑指Offer面试题[16]数值的整数次方/" class="post-title-link" itemprop="url">剑指Offer面试题[16]数值的整数次方</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2019-12-05 14:44:48" itemprop="dateCreated datePublished" datetime="2019-12-05T14:44:48+08:00">2019-12-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据结构与算法/" itemprop="url" rel="index"><span itemprop="name">数据结构与算法</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span title="Symbols count in article">0</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">1 mins.</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="面试题16-数值的整数次方"><a href="#面试题16-数值的整数次方" class="headerlink" title="面试题16:数值的整数次方"></a>面试题16:数值的整数次方</h1><p>题目：实现函数double Power(doubele base, iont exponent), 求base的exponent次方。 不得使用库函数，同时不需要考虑大数问题。</p><h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><h2 id="普通解法"><a href="#普通解法" class="headerlink" title="普通解法"></a>普通解法</h2><p>下面这种解法只考虑了指数为正数的情况，并没有考虑指数小于1（0以及负正数）的情况：<br></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Power</span><span class="params">(<span class="keyword">double</span> base, <span class="keyword">int</span> exponent)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> result=<span class="number">1.0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i&lt;=exponent; ++i)</span><br><span class="line">        result*=base;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h2 id="进阶解法"><a href="#进阶解法" class="headerlink" title="进阶解法"></a>进阶解法</h2><p>当指数为负时，可以先对指数求绝对值，算出次方的结果之后再取倒数。但是要避免底数为0时，对其进行负幂运算。<br></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> g_InvalidInput = <span class="literal">false</span>;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Power</span><span class="params">(<span class="keyword">double</span> base, <span class="keyword">int</span> exponent)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    g_InvalidInput=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(equal(base, <span class="number">0.0</span>)&amp;&amp;exponent&lt;<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        g_InvalidInput=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> absExponent=(<span class="keyword">unsigned</span> <span class="keyword">int</span>)(exponent);</span><br><span class="line"><span class="keyword">if</span>(exponent&lt;<span class="number">0</span>)</span><br><span class="line">    absExponent=(<span class="keyword">unsigned</span> <span class="keyword">int</span>)(-exponent);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> result=PowerWithUnsignedExponent(base, basExponent);</span><br><span class="line">    <span class="keyword">if</span>(exponent&lt;<span class="number">0</span>)</span><br><span class="line">        result = <span class="number">1.0</span>/result;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">PowerWithUnsignedExponent</span><span class="params">(<span class="keyword">double</span> base, <span class="keyword">unsigned</span> <span class="keyword">int</span> exponent)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> result = <span class="number">1.0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i= <span class="number">1</span>; i&lt;=exponent; ++i)</span><br><span class="line">        result *=base;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>另在上述代码中，我们用全局变量标识是否出错。如果出错，则返回值是0。为了区分出错的时候返回0，还是底数为0的时候正常运行返回的零，我们使用全局变量g_InvalidInput进行标识。</p><h2 id="完美解法"><a href="#完美解法" class="headerlink" title="完美解法"></a>完美解法</h2><p>加速运算，将指数运算拆分成若干指数运算的乘积：<br>$$a^n=\begin{cases}<br>a^{n/2}\cdot a^{n/2} &amp; n为偶数 \<br>a^{(n-1)/2}\cdot a^{(n-1)/2} &amp; n为奇数\<br>\end{cases}$$<br>然后使用递归法求运算结果。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">PowerWithUnsignedExponent</span><span class="params">(<span class="keyword">double</span>  base, <span class="keyword">unsigned</span> <span class="keyword">int</span> exponent)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(exponent == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(exponent == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> base;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">double</span> result=PowerWithUnsignedExponent(base, exponent&gt;&gt;<span class="number">1</span>);</span><br><span class="line">    result *=result;</span><br><span class="line">    <span class="keyword">if</span>(exponent &amp; <span class="number">0x1</span>==<span class="number">1</span>)</span><br><span class="line">        result*=base;</span><br><span class="line">    <span class="keyword">return</span> result;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在上述代码中，我们还是用了两个小技巧：用右移运算符代替除以2，用位与运算符(%)来判断一个数是偶数还是奇数。因为位运算比size运算的效率要高很多，这样可以起到优化代码的作用。</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.flyinghuster.com/Ubuntu Server网络配置/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="刘中岳"><meta itemprop="description" content="飞翔的Huster"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="The Flying Huster"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"><a href="/Ubuntu Server网络配置/" class="post-title-link" itemprop="url">Ubuntu Server网络配置</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">Posted on</span> <time title="Created: 2019-12-05 03:49:37" itemprop="dateCreated datePublished" datetime="2019-12-05T03:49:37+08:00">2019-12-05</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">In</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Ubuntu/" itemprop="url" rel="index"><span itemprop="name">Ubuntu</span></a></span> , <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Ubuntu/Server/" itemprop="url" rel="index"><span itemprop="name">Server</span></a></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">Symbols count in article: </span><span title="Symbols count in article">0</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">Reading time &asymp;</span> <span title="Reading time">1 mins.</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="需求背景"><a href="#需求背景" class="headerlink" title="需求背景"></a>需求背景</h1><p>需求：在进行内网穿透的实验过程中，需要将Ubuntu server的IPv4分配方式改为静态。</p><p>Ubuntu自17.10开始，就放弃使用/etc/network/interfaces进行Ip配置。因此，即使在新版本里对interfaces进行了配置，也不会生效。</p><p>新的方法是使用netplan方式进行配置 ，配置写在/etc/netplan/01-netcfg.yaml或者类似名称的yaml文件里。</p><p>Ubuntu Server 18.04的yaml配置文件是：/etc/netplan/50-cloud-init.yaml，修改配置以后不用重启，直接执行netplan apply 命令即可以让配置生效。</p><p>注意：以前的重启网络服务命令/etc/init.d/networking restart或者services network restrart也都会提示为无效命令。</p><h1 id="yaml配置模板"><a href="#yaml配置模板" class="headerlink" title="yaml配置模板"></a>yaml配置模板</h1><p>下面是我的配置模板：<br></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This file is generated from information provided by</span></span><br><span class="line"><span class="comment"># the datasource.  Changes to it will not persist across an instance.</span></span><br><span class="line"><span class="comment"># To disable cloud-init's network configuration capabilities, write a file</span></span><br><span class="line"><span class="comment"># /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:</span></span><br><span class="line"><span class="comment"># network: &#123;config: disabled&#125;</span></span><br><span class="line"><span class="attr">network:</span></span><br><span class="line">    <span class="attr">ethernets:</span></span><br><span class="line">        <span class="attr">enp9s0:</span></span><br><span class="line">            <span class="attr">addresses:</span></span><br><span class="line">                <span class="bullet">-</span> <span class="number">192.168</span><span class="number">.133</span><span class="number">.120</span><span class="string">/24</span></span><br><span class="line">            <span class="attr">dhcp4:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">gateway4:</span> <span class="number">192.168</span><span class="number">.133</span><span class="number">.1</span></span><br><span class="line">            <span class="attr">nameservers:</span></span><br><span class="line">                <span class="attr">addresses:</span></span><br><span class="line">                <span class="bullet">-</span> <span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span></span><br><span class="line">                <span class="attr">search:</span> <span class="string">[]</span></span><br><span class="line">    <span class="attr">version:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article></section><nav class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><div class="site-overview-wrap sidebar-panel sidebar-panel-active"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="刘中岳"><p class="site-author-name" itemprop="name">刘中岳</p><div class="site-description motion-element" itemprop="description">飞翔的Huster</div></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">43</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">15</span> <span class="site-state-item-name">categories</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">24</span> <span class="site-state-item-name">tags</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/johannesliu" title="GitHub &rarr; https://github.com/johannesliu" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a> </span><span class="links-of-author-item"><a href="mailto:iexkliu@gmail.com" title="E-Mail &rarr; mailto:iexkliu@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i></a> </span><span class="links-of-author-item"><a href="https://plus.google.com/iexkliu" title="Google &rarr; https://plus.google.com/iexkliu" rel="noopener" target="_blank"><i class="fa fa-fw fa-google"></i></a> </span><span class="links-of-author-item"><a href="https://twitter.com/iexkliu" title="Twitter &rarr; https://twitter.com/iexkliu" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i></a> </span><span class="links-of-author-item"><a href="https://www.facebook.com/iexkliu" title="FB Page &rarr; https://www.facebook.com/iexkliu" rel="noopener" target="_blank"><i class="fa fa-fw fa-facebook"></i></a> </span><span class="links-of-author-item"><a href="https://youtube.com/iexkliu" title="YouTube &rarr; https://youtube.com/iexkliu" rel="noopener" target="_blank"><i class="fa fa-fw fa-youtube"></i></a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="52" src="//music.163.com/outchain/player?type=2&id=817740&auto=1&height=32"></iframe></div></div></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"><span style="padding-left:25px;background:url(https://static.dy208.cn/o_1dfilp8ruo521thr1hvf18ji17soa.png) no-repeat left center" rel="nofollow"><a href="http://www.beian.miit.gov.cn" rel="noopener" target="_blank">豫ICP备19040049号-1| </a><span style="padding-left:25px;background:url(https://www.return520.com/images/beian.png) no-repeat left center" rel="nofollow"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=" rel="noopener" target="_blank">豫公网安备 41132402411642号 </a>&copy; 2019 - <span itemprop="copyrightYear">2020</span> <span class="with-love" id="animate"><i class="fa fa-at"></i> </span><span class="author" itemprop="copyrightHolder">刘中岳</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span class="post-meta-item-text">Symbols count total: </span><span title="Symbols count total">119k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">Reading time total &asymp;</span> <span title="Reading time total">1:26</span></span></span></div><div><span id="runtime_span"></span><script type="text/javascript">function show_runtime(){window.setTimeout("show_runtime()",1e3),X=new Date("11/08/2019 11:10:17"),Y=new Date,T=Y.getTime()-X.getTime(),M=864e5,a=T/M,A=Math.floor(a),b=24*(a-A),B=Math.floor(b),c=60*(b-B),C=Math.floor(60*(b-B)),D=Math.floor(60*(c-C)),runtime_span.innerHTML="本站勉强运行: "+A+"天"+B+"小时"+C+"分"+D+"秒"}show_runtime()</script></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="Total Visitors"><span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="Total Views"><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div><script>!function(){var e=document.createElement("script");e.src="//tajs.qq.com/stats?sId=66487025";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div style="display:none"><script src="//s95.cnzz.com/z_stat.php?id=1278185485&web_id=1278185485"></script></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script color="255,0,255" opacity="0.8" zindex="-1" count="200" src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest.min.js"></script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="/js/utils.js?v=7.1.2"></script><script src="/js/motion.js?v=7.1.2"></script><script src="/js/affix.js?v=7.1.2"></script><script src="/js/schemes/pisces.js?v=7.1.2"></script><script src="/js/next-boot.js?v=7.1.2"></script><script>function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var e=$("#local-search-input");e.attr("autocapitalize","none"),e.attr("autocorrect","off"),e.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(e){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(e,t,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:e,dataType:isXml?"xml":"json",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():e,r=document.getElementById(t),s=document.getElementById(o),a=function(){var e=r.value.trim().toLowerCase(),t=e.split(/[\s\-]+/);t.length>1&&t.push(e);var o=[];if(e.length>0&&n.forEach(function(n){function r(t,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===e&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(e,t){var o="",n=t.start;return t.hits.forEach(function(t){o+=e.substring(n,t.position);var r=t.position+t.length;o+='<b class="search-keyword">'+e.substring(t.position,r)+"</b>",n=r}),o+=e.substring(n,t.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url).replace(/\/{2,}/g,"/"),d=[],g=[];if(""!=l&&(t.forEach(function(e){function t(e,t,o){var n=e.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(t=t.toLowerCase(),e=e.toLowerCase());(s=t.indexOf(e,r))>-1;)a.push({position:s,word:e}),r=s+n;return a}d=d.concat(t(e,h,!1)),g=g.concat(t(e,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(e){e.sort(function(e,t){return t.position!==e.position?t.position-e.position:e.word.length-t.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;w<0&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(e,t){return e.searchTextCount!==t.searchTextCount?t.searchTextCount-e.searchTextCount:e.hits.length!==t.hits.length?t.hits.length-e.hits.length:e.start-t.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(e){b+="<a href='"+f+'\'><p class="search-result">'+s(p,e)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===t.length&&""===t[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x"></i></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>';else{o.sort(function(e,t){return e.searchTextCount!==t.searchTextCount?t.searchTextCount-e.searchTextCount:e.hitCount!==t.hitCount?t.hitCount-e.hitCount:t.id-e.id});var a='<ul class="search-result-list">';o.forEach(function(e){a+=e.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(e){e.stopPropagation()}),$(document).on("keyup",function(e){var t=27===e.which&&$(".search-popup").is(":visible");t&&onPopupClose()})</script><script>$("body").find("div.pdf").length&&$.ajax({type:"GET",url:"//cdn.jsdelivr.net/npm/pdfobject@2/pdfobject.min.js",dataType:"script",cache:!0,success:function(){$("body").find("div.pdf").each(function(e,t){PDFObject.embed($(t).attr("target"),$(t),{pdfOpenParams:{navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"},PDFJS_URL:"/lib/pdf/web/viewer.html",height:$(t).attr("height")||"500px"})})}})</script><script>$(".highlight").not(".gist .highlight").each(function(e,t){var n=$("<div>").addClass("highlight-wrap");$(t).after(n),n.append($("<button>").addClass("copy-btn").append("Copy").on("click",function(e){var t=$(this).parent().find(".code").find(".line").map(function(e,t){return $(t).text()}).toArray().join("\n"),n=document.createElement("textarea"),o=window.pageYOffset||document.documentElement.scrollTop;n.style.top=o+"px",n.style.position="absolute",n.style.opacity="0",n.readOnly=!0,n.value=t,document.body.appendChild(n);const a=document.getSelection(),i=a.rangeCount>0&&a.getRangeAt(0);n.select(),n.setSelectionRange(0,t.length),n.readOnly=!1;var d=document.execCommand("copy");d?$(this).text("Copied"):$(this).text("Copy failed"),n.blur(),$(this).blur(),i&&(a.removeAllRanges(),a.addRange(i))})).on("mouseleave",function(e){var t=$(this).find(".copy-btn");setTimeout(function(){t.text("Copy")},300)}).append(t)})</script></body></html><!-- rebuild by neat -->